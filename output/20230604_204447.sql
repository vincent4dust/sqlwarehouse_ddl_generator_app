CREATE OR REPLACE VIEW DNA_CON_CRN.CRN_AGENT_CLIENT
AS
SELECT
AGY_CD,
CLIENT_NO,
CASE
	WHEN IS_MEMBER('UAT_C') THEN ALIAS_NAME
	ELSE 'NO ACCESS'
END AS ALIAS_NAME
FROM
DNA_CON_CRN_DELTA.CRN_AGENT_CLIENT;
ALTER VIEW DNA_CON_CRN.CRN_AGENT_CLIENT OWNER TO hive_owner;

CREATE OR REPLACE VIEW DNA_CON_CRN.CRN_AGENT_CLIENT_HIS
AS
SELECT
AGY_CD,
CLIENT_NO,
CASE
	WHEN IS_MEMBER('UAT_C') THEN ALIAS_NAME
	ELSE 'NO ACCESS'
END AS ALIAS_NAME,
IS_ACTIVE,
EFF_ST_DT,
EFF_END_DT
FROM
DNA_CON_CRN_DELTA.CRN_AGENT_CLIENT_HIS;
ALTER VIEW DNA_CON_CRN.CRN_AGENT_CLIENT_HIS OWNER TO hive_owner;

CREATE OR REPLACE VIEW DNA_CON_POL.POL_COSTOA
AS
SELECT
COL_A,
CASE
	WHEN IS_MEMBER('UAT_P') THEN COL_B
	ELSE 'NO ACCESS'
END AS COL_B,
COL_C
FROM
DNA_CON_POL_DELTA.POL_COSTOA;
ALTER VIEW DNA_CON_POL.POL_COSTOA OWNER TO hive_owner;

CREATE OR REPLACE VIEW DNA_CON_POL.POL_COSTOA_HIS
AS
SELECT
COL_A,
CASE
	WHEN IS_MEMBER('UAT_P') THEN COL_B
	ELSE 'NO ACCESS'
END AS COL_B,
COL_C,
IS_ACTIVE,
EFF_ST_DT,
EFF_END_DT
FROM
DNA_CON_POL_DELTA.POL_COSTOA_HIS;
ALTER VIEW DNA_CON_POL.POL_COSTOA_HIS OWNER TO hive_owner;

